# StudyScriber æ¸¬è©¦å·¥å…·

## WebSocket æ¨é€æ¸¬è©¦

### ğŸ§ª æ¸¬è©¦å·¥å…·

1. **`test/websocket_push_test.py`** - å®Œæ•´çš„ WebSocket æ¨é€æ¸¬è©¦
2. **`test/websocket_debug.py`** - å¿«é€Ÿé™¤éŒ¯å·¥å…·  
3. **`test/simple_websocket_test.py`** - ç°¡åŒ–æ¸¬è©¦å·¥å…·
4. **`test/frontend_debug.html`** - å‰ç«¯ WebSocket é™¤éŒ¯å·¥å…·

### ç›®çš„
æ¸¬è©¦å¾Œç«¯ WebSocket æ˜¯å¦æ­£ç¢ºæ¨é€é€å­—ç¨¿åˆ°å‰ç«¯æ‡‰ç”¨ç¨‹å¼ã€‚

### æ¸¬è©¦æ­¥é©Ÿ

#### 1. å•Ÿå‹•æœå‹™
```bash
# å•Ÿå‹•å¾Œç«¯æœå‹™
uv run python main.py

# å•Ÿå‹•å‰ç«¯æœå‹™ï¼ˆå¦ä¸€å€‹çµ‚ç«¯ï¼‰
cd frontend
npm run dev
```

#### 2. å»ºç«‹éŒ„éŸ³ Session
1. é–‹å•Ÿç€è¦½å™¨åˆ° `http://localhost:3000`
2. é»æ“Šã€Œé–‹å§‹éŒ„éŸ³ã€æŒ‰éˆ•
3. å‰ç«¯æœƒå»ºç«‹æ–°çš„éŒ„éŸ³ session ä¸¦è½‰åˆ° recording ç‹€æ…‹

#### 3. å–å¾— Session ID
å¾ç€è¦½å™¨é–‹ç™¼è€…å·¥å…·ä¸­æ‰¾åˆ° session_idï¼š

**æ–¹æ³• 1: å¾ Network é¢æ¿**
- é–‹å•Ÿ F12 é–‹ç™¼è€…å·¥å…·
- åˆ‡æ›åˆ° Network é¢æ¿
- å°‹æ‰¾ WebSocket é€£æ¥ï¼ŒURL é¡ä¼¼ï¼š`ws://localhost:8000/ws/transcript_feed/{session_id}`
- è¤‡è£½ session_id

**æ–¹æ³• 2: å¾ Console é¢æ¿**
- é–‹å•Ÿ F12 é–‹ç™¼è€…å·¥å…·
- åˆ‡æ›åˆ° Console é¢æ¿
- å°‹æ‰¾é¡ä¼¼è¨Šæ¯ï¼š`âœ… WebSocket é€£æ¥æˆåŠŸ: ws://localhost:8000/ws/transcript_feed/{session_id}`
- è¤‡è£½ session_id

#### 4. åŸ·è¡Œæ¨é€æ¸¬è©¦
```bash
# åŸ·è¡Œ WebSocket æ¨é€æ¸¬è©¦
python test/websocket_push_test.py <session_id>

# ç¯„ä¾‹
python test/websocket_push_test.py 12345678-1234-1234-1234-123456789abc
```

#### 5. è§€å¯Ÿçµæœ
åœ¨å‰ç«¯æ‡‰ç”¨ç¨‹å¼ä¸­è§€å¯Ÿï¼š

âœ… **æ­£å¸¸æƒ…æ³ä¸‹æ‡‰è©²çœ‹åˆ°ï¼š**
- RecordingState çµ„ä»¶çš„é€å­—ç¨¿å€åŸŸé¡¯ç¤ºæ¸¬è©¦æ–‡å­—
- é€å­—ç¨¿æŒ‰é †åºå‡ºç¾ï¼ˆæ¯3ç§’ä¸€æ®µï¼‰
- æ”¶åˆ° `transcript_complete` å¾Œç‹€æ…‹è½‰ç‚º `finished`
- ç€è¦½å™¨ Console ç„¡éŒ¯èª¤è¨Šæ¯

âŒ **å•é¡Œæƒ…æ³ï¼š**
- é€å­—ç¨¿å€åŸŸç©ºç™½æˆ–ä¸æ›´æ–°
- Console æœ‰ WebSocket éŒ¯èª¤
- ç‹€æ…‹æœªæ­£ç¢ºè½‰æ›

### æ¸¬è©¦è¨Šæ¯å…§å®¹
æ¸¬è©¦è…³æœ¬æœƒä¾åºæ¨é€ä»¥ä¸‹é€å­—ç¨¿ï¼š
1. "æ­¡è¿ä½¿ç”¨ StudyScriber é›²ç«¯ç­†è¨˜æ‡‰ç”¨ç¨‹å¼"
2. "é€™æ˜¯ä¸€å€‹æ”¯æ´å³æ™‚èªéŸ³è½‰éŒ„çš„æ™ºæ…§ç­†è¨˜å·¥å…·"
3. "æˆ‘å€‘æ­£åœ¨æ¸¬è©¦ WebSocket æ¨é€åŠŸèƒ½æ˜¯å¦æ­£å¸¸é‹ä½œ"
4. "å¦‚æœä½ èƒ½åœ¨å‰ç«¯çœ‹åˆ°é€™äº›æ–‡å­—ï¼Œè¡¨ç¤ºæ¨é€åŠŸèƒ½æ­£å¸¸"
5. "æ¥ä¸‹ä¾†æœƒæ¸¬è©¦æ›´é•·çš„é€å­—ç¨¿å…§å®¹"
6. "åŒ…å«æ¨™é»ç¬¦è™Ÿã€æ•¸å­— 123 å’Œè‹±æ–‡ Hello World"
7. "æœ€å¾Œæˆ‘å€‘æœƒç™¼é€è½‰éŒ„å®Œæˆçš„è¨Šæ¯"

### ç–‘é›£æ’è§£

#### é€£æ¥å¤±æ•—
- ç¢ºèªå¾Œç«¯æœå‹™æ­£åœ¨é‹è¡Œ
- ç¢ºèª WebSocket ç«¯é»å¯ç”¨
- æª¢æŸ¥ session_id æ˜¯å¦æ­£ç¢º

#### å‰ç«¯ç„¡åæ‡‰
- æª¢æŸ¥å‰ç«¯æ˜¯å¦åœ¨ recording ç‹€æ…‹
- æª¢æŸ¥ç€è¦½å™¨ Console æ˜¯å¦æœ‰éŒ¯èª¤
- ç¢ºèª TranscriptWebSocket é€£æ¥æ­£å¸¸

#### ç‹€æ…‹æœªè½‰æ›
- æª¢æŸ¥ useAppState Hook æ˜¯å¦æ­£ç¢ºè™•ç† `transcript_complete`
- æª¢æŸ¥ TranscriptManager æ˜¯å¦æ­£ç¢ºæ¥æ”¶è¨Šæ¯

### é€²éšæ¸¬è©¦

#### æ‰‹å‹•æ¸¬è©¦ç‰¹å®šè¨Šæ¯
ä¿®æ”¹ `test/websocket_push_test.py` ä¸­çš„ `test_segments` é™£åˆ—ä¾†æ¸¬è©¦ç‰¹å®šå…§å®¹ã€‚

#### æ¸¬è©¦ä¸åŒè¨Šæ¯æ ¼å¼
å¯ä»¥ä¿®æ”¹ `create_test_transcript_message` æ–¹æ³•ä¾†æ¸¬è©¦ä¸åŒçš„è¨Šæ¯æ ¼å¼ã€‚

## ğŸ”§ å‰ç«¯é™¤éŒ¯å·¥å…·

å¦‚æœå‰ç«¯æ‡‰ç”¨ç¨‹å¼ç„¡æ³•æ­£å¸¸é¡¯ç¤ºé€å­—ç¨¿ï¼Œå¯ä»¥ä½¿ç”¨å°ˆé–€çš„é™¤éŒ¯å·¥å…·ï¼š

### ä½¿ç”¨ `test/frontend_debug.html`
1. ç”¨ç€è¦½å™¨é–‹å•Ÿ `file:///path/to/test/frontend_debug.html`
2. è¼¸å…¥ Session IDï¼ˆæˆ–ä½¿ç”¨é è¨­å€¼ï¼‰
3. é»æ“Šã€Œé€£æ¥ WebSocketã€
4. åœ¨å¦ä¸€å€‹çµ‚ç«¯åŸ·è¡Œæ¨é€æ¸¬è©¦ï¼š
   ```bash
   python test/simple_websocket_test.py <session_id>
   ```
5. è§€å¯Ÿé™¤éŒ¯é é¢çš„æ—¥èªŒï¼Œç¢ºèªï¼š
   - WebSocket æ˜¯å¦æˆåŠŸé€£æ¥
   - æ˜¯å¦æ”¶åˆ°é€å­—ç¨¿è¨Šæ¯
   - è¨Šæ¯æ ¼å¼æ˜¯å¦æ­£ç¢º

### é™¤éŒ¯åŠŸèƒ½
- **å³æ™‚é€£æ¥ç‹€æ…‹**ï¼šé¡¯ç¤º WebSocket é€£æ¥ç‹€æ…‹
- **è¨Šæ¯æ—¥èªŒ**ï¼šè¨˜éŒ„æ‰€æœ‰æ”¶ç™¼çš„è¨Šæ¯
- **æ¸¬è©¦å·¥å…·**ï¼šå¯ç™¼é€ ping è¨Šæ¯æ¸¬è©¦é€£æ¥
- **é€å­—ç¨¿é«˜äº®**ï¼šç‰¹åˆ¥æ¨™ç¤ºé€å­—ç¨¿å…§å®¹

### ç›¸é—œæª”æ¡ˆ
- `test/websocket_push_test.py` - WebSocket æ¨é€æ¸¬è©¦è…³æœ¬
- `test/frontend_debug.html` - å‰ç«¯ WebSocket é™¤éŒ¯å·¥å…·
- `frontend/lib/websocket.ts` - å‰ç«¯ WebSocket ç®¡ç†
- `frontend/hooks/use-transcript.ts` - é€å­—ç¨¿æ¥æ”¶ Hook
- `app/ws/transcript_feed.py` - å¾Œç«¯ WebSocket ç«¯é» 

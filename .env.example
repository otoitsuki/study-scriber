# StudyScriber 環境變數

# ============================================
# Supabase 資料庫配置 (必須)
# ============================================
DB_MODE=supabase
SUPABASE_URL=https://your-project-ref.supabase.co
SUPABASE_KEY=your-anon-public-key

# ============================================
# 語音轉文字 Provider 設定
# ============================================
# 預設 STT Provider：whisper (Azure OpenAI) 或 gemini (Google Vertex AI)
STT_PROVIDER_DEFAULT=whisper

# ============================================
# Azure OpenAI 服務 (必須)
# ============================================
AZURE_OPENAI_API_KEY=your-api-key
AZURE_OPENAI_ENDPOINT=https://your-resource.openai.azure.com/
AZURE_OPENAI_API_VERSION=2024-02-01

# ============================================
# Azure OpenAI 摘要功能設定 (可選)
# ============================================
# （已暫時移除摘要功能設定）


# ============================================
# Whisper 服務
# ============================================
WHISPER_DEPLOYMENT_NAME=whisper-1

# ============================================
# Google Vertex AI 服務 (Gemini STT - 可選)
# ============================================
# 取消註釋以下設定以啟用 Gemini 2.5 Pro STT
# GEMINI_ENDPOINT=us-central1-aiplatform.googleapis.com
# GEMINI_API_KEY=your-gcp-service-account-key
# GEMINI_PROMPT=請輸出逐字稿：
# GEMINI_MAX_REQUESTS=90


# ============================================
# Azure OpenAI 批次處理設定 (優化為低延遲)
# ============================================

# 批次處理設定 (優化為低延遲)
# 批次大小：2個音檔切片
WHISPER_BATCH_SIZE=2
# 批次超時：3秒 (目標延遲 ≤5秒)
WHISPER_BATCH_TIMEOUT=3

# 效能監控設定
# 啟用效能日誌記錄
ENABLE_PERFORMANCE_LOGGING=true

# ============================================
# Whisper 幻覺過濾設定 (提升轉錄品質)
# ============================================
# 這些參數用於過濾 Azure Whisper API 產生的低品質或幻覺段落
# 使用 verbose_json 格式的回應進行後端自動過濾

# 靜音檢測門檻 - 過濾高靜音機率的段落
# 範圍：0.0-1.0，值越高越嚴格
# 建議值：0.8 (過濾 80% 以上靜音機率的段落)
# 用途：移除「嗯」、「呃」等填充詞和靜音片段
FILTER_NO_SPEECH=0.8

# 置信度過濾門檻 - 過濾低置信度的段落
# 範圍：-5.0 到 0.0，值越高越嚴格
# 建議值：-1.0 (過濾平均對數機率低於 -1.0 的段落)
# 用途：移除模型不確定的轉錄結果
FILTER_LOGPROB=-1.0

# 重複內容檢測門檻 - 過濾高重複比率的段落
# 範圍：1.0+，值越低越嚴格
# 建議值：2.4 (過濾壓縮比大於 2.4 的段落)
# 用途：移除重複文字、迴圈幻覺等內容
FILTER_COMPRESSION=2.4

# ============================================
# 音頻切片配置 (影響前後端錄音切片時間)
# ============================================
# 音頻切片時長（秒）- 同時影響前後端錄音間隔
# 建議值：5-30秒，預設10秒
AUDIO_CHUNK_DURATION_SEC=5

# ============================================
# 應用程式設定 (可選)
# ============================================
DEBUG=false
LOG_LEVEL=INFO
